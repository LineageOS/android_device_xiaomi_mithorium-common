type subsystem_state_notifier_script, domain;
type subsystem_state_notifier_script_exec, exec_type, vendor_file_type, file_type;

# Allow for transition from init domain to subsystem_state_notifier_script
init_daemon_domain(subsystem_state_notifier_script)

# Shell script needs to execute /vendor/bin/sh
allow subsystem_state_notifier_script vendor_shell_exec:file rx_file_perms;
allow subsystem_state_notifier_script vendor_toolbox_exec:file rx_file_perms;

# Allow to read sysfs_modem_subsys
allow subsystem_state_notifier_script sysfs_modem_subsys:file r_file_perms;

# Allow to access subsys state notifier props
set_prop(subsystem_state_notifier_script, vendor_subsys_state_notifier_prop)
